!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="ed61cd8c-11c7-4de3-96ea-24f69ae6bdf6",e._sentryDebugIdIdentifier="sentry-dbid-ed61cd8c-11c7-4de3-96ea-24f69ae6bdf6")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"0.17.3"};"use strict";(self.webpackChunk_leap_cosmos_extension=self.webpackChunk_leap_cosmos_extension||[]).push([["9377"],{84166:function(e,t,s){var a,l,n,r,i,o;s.d(t,{z3:()=>l,JY:()=>d}),(r=a||(a={})).DISCONNECT="disconnect",r.GET_KEYS="get-keys",r.GET_NETWORK="get-network",r.SIGN_TRANSACTION="sign-transaction",r.SWITCH_NETWORK="switch-chain",r.SIGN_MESSAGE="sign-message",(i=l||(l={})).CONNECT_WALLET="connect-wallet",i.GET_ADDRESS="get-address",i.GET_ACCOUNTS="get-accounts",i.GET_NETWORK="get-network",i.GET_PUBLIC_KEY="get-public-key",i.REQUEST_ACCOUNTS="request-accounts",i.SEND_BITCOIN="send-bitcoin",i.SIGN_MESSAGE="sign-message",i.SIGN_PSBT="sign-psbt",i.SIGN_PSBTS="sign-psbts",i.SWITCH_NETWORK="switch-network";let d=Object.assign(Object.assign({},{ETH__ACCOUNTS:"eth_accounts",ETH__CHAIN_ID:"eth_chainId",ETH__CALL:"eth_call",ETH__GET_BALANCE:"eth_getBalance",ETH__BLOCK_NUMBER:"eth_blockNumber",ETH__ESTIMATE_GAS:"eth_estimateGas",ETH__GAS_PRICE:"eth_gasPrice",ETH__GET_BLOCK_BY_NUMBER:"eth_getBlockByNumber",WALLET__REVOKE_PERMISSIONS:"wallet_revokePermissions",ETH__GET_TRANSACTION_RECEIPT:"eth_getTransactionReceipt",ETH__GET_TRANSACTION_BY_HASH:"eth_getTransactionByHash",ETH__GET_TRANSACTION_COUNT:"eth_getTransactionCount"}),{ETH__REQUEST_ACCOUNTS:"eth_requestAccounts",ETH__SEND_TRANSACTION:"eth_sendTransaction",ETH__SIGN:"eth_sign",ETH__SIGN_TYPED_DATA_V4:"eth_signTypedData_v4",PERSONAL_SIGN:"personal_sign",WALLET__REQUEST_PERMISSIONS:"wallet_requestPermissions",WALLET__WATCH_ASSET:"wallet_watchAsset",WALLET__SWITCH_ETHEREUM_CHAIN:"wallet_switchEthereumChain",WALLET__ADD_ETHEREUM_CHAIN:"wallet_addEthereumChain"}),c=4001,u=-32602;(o=n||(n={})).MAINNET="mainnet",o.TESTNET="testnet",o.SIGNET="signet",s("28649")},99188:function(e,t,s){s.d(t,{m:function(){return i}});var a=s(52322),l=s(94184),n=s.n(l),r=s(2784);let i=e=>{let{tabsList:t,tabsContent:s,className:l}=e,[i,o]=r.useState(t[0].id);return(0,a.jsxs)("div",{className:n()("w-full",l),children:[(0,a.jsx)("div",{className:"w-full flex items-center justify-start border-b border-gray-900",children:t.map(e=>{let{id:t,label:s}=e;return(0,a.jsx)("button",{className:`px-4 py-2 cursor-pointer transition-colors border-b-2 ${i===t?"dark:border-white-100 border-gray-900 font-bold text-gray-900 dark:text-white-100":"border-transparent text-gray-700 dark:text-gray-400"}`,onClick:()=>o(t),children:s},t)})}),(0,a.jsx)("div",{className:"w-full",children:s[i]})]})}},74703:function(e,t,s){s.d(t,{u:function(){return l}});var a,l=((a={}).signResponse="sign-response",a.signingPopupOpen="signing-popup-open",a.signTransaction="sign-transaction",a.signBitcoinResponse="sign-bitcoin-response",a.signSeiEvmResponse="sign-sei-evm-response",a)},91846:function(e,t,s){s.r(t),s.d(t,{default:()=>X});var a=s("52322"),l=s("21950"),n=s("84166"),r=s("65209"),i=s("74703"),o=s("53108"),d=s("71566"),c=s("2784"),u=s("10289"),x=s("42799"),m=s("48346"),g=s("72565"),p=s.n(g),h=s("39279"),f=s("3929"),y=s("19623");function w(){return(0,a.jsx)(f.Z,{className:"self-center justify-self-center",header:(0,a.jsx)(h.Header,{title:"Sign Transaction"}),children:(0,a.jsx)("div",{className:"h-full w-full flex flex-col gap-4 items-center justify-center",children:(0,a.jsx)(y.T,{color:"white"})})})}var v=s("56594"),b=s("2826"),N=s("26089"),j=s("69282"),_=s.n(j),S=s("94184"),T=s.n(S),E=s("69332"),k=s("86200"),I=s("23060"),C=s("99188"),A=s("78935"),D=s("81252"),G=s("98851"),B=s("75958"),L=s("46103"),R=s("32374"),H=s("49409"),O=s("48534"),P=s("71198");async function M(e,t){await p().runtime.sendMessage({type:i.u.signBitcoinResponse,payloadId:t,payload:{status:"error",data:"User rejected the transaction"}}),(0,O.oj)()?e("/home"):window.close()}let W=D.w.useGetWallet,U=(0,B.Pi)(e=>{var t,s,n;let{txnData:r,rootDenomsStore:o,rootBalanceStore:x}=e,m=W(),g=(0,l.FmJ)(),w=(0,u.s0)(),j=(0,d.a7)(),S=(0,l.QSC)(j),D=(0,l.rTu)();_()(null!==D,"activeWallet is null");let B=(0,c.useMemo)(()=>(0,R.k)(D.name),[D.name]),U=(0,l.SFn)(),$=null==r?void 0:r.origin,z=null==$?void 0:null===(n=$.split("//"))||void 0===n?void 0:null===(s=n.at(-1))||void 0===s?void 0:null===(t=s.split("."))||void 0===t?void 0:t.at(-2),K=(0,A.G)($),{rpcUrl:Q}=(0,l.U9i)(j),[Z,q]=(0,c.useState)(""),F=(0,l.dco)(),Y=(0,l._ty)(j),J=(0,c.useMemo)(()=>{var e;return parseInt((((null===(e=F[j])||void 0===e?void 0:e.DEFAULT_GAS_IBC)??b.N7W.DEFAULT_GAS_IBC)*Y).toString())},[j,F,Y]),[V,X]=(0,c.useState)(J),[ee,et]=(0,c.useState)(null),es=(0,I.e7)(o.allDenoms,{activeChain:j}),[ea,el]=(0,c.useState)({gasPrice:es.gasPrice,option:l.j1p.LOW}),[en,er]=(0,c.useState)("idle"),[ei,eo]=(0,c.useState)(null),[ed,ec]=(0,c.useState)(!1),eu=l.rNU.useLogCosmosDappTx(),ex=(0,c.useMemo)(()=>{let e=Z??V;if(ea.gasPrice)return(0,v.calculateFee)(Math.ceil(Number(e)),ea.gasPrice)},[Z,V,ea.gasPrice]);(0,c.useEffect)(()=>{!async function(){if(Q){ec(!0);let e=await (0,b.ZrD)(U,Q);X((0,b.XWe)(e.length,2,"p2wpkh")),ec(!1)}}()},[U,Q]);let em=(0,c.useCallback)(()=>{setTimeout(()=>{x.refetchBalances(j)},3e3)},[j,x]),eg=async()=>{try{if(D.walletType===l._KQ.LEDGER)throw Error("Ledger transactions are not supported yet");if(ex){eo(null),er("loading");let e=await m(j),t="bitcoin"===j?"mainnet":"testnet",s=new b.DwL(t,e,Q),a=parseInt(ex.amount[0].amount)/parseInt(ex.gas),n=e.getAccounts();if(!n[0].pubkey)throw Error("No public key found");let o=await s.createTransaction({sourceAddress:U,addressType:"p2wpkh",destinationAddress:r.signTxnData.to,amount:Number(r.signTxnData.amount),feeRate:a,pubkey:n[0].pubkey});try{await eu({txHash:o.txHex,txType:l.pb0.Dapp,metadata:{...g,dapp_url:$??origin},feeQuantity:ex.amount[0].amount,feeDenomination:ex.amount[0].denom,address:U,chain:j})}catch(e){(0,N.Tb)(e,{extra:{extra_info:"Bitcoin dApp sendBitcoin Error -- txPostToDB: "}})}er("success");try{p().runtime.sendMessage({type:i.u.signBitcoinResponse,payloadId:null==r?void 0:r.payloadId,payload:{status:"success",data:o.txId}})}catch{throw Error("Could not send transaction to the dApp")}(0,O.oj)()?(em(),w("/home")):window.close()}}catch(e){er("error"),eo(e.message)}},ep=!!ei||"loading"===en||!!ee||ed;return(0,a.jsx)("div",{className:T()("panel-width enclosing-panel h-full relative self-center justify-self-center flex justify-center items-center",{"mt-2":!(0,O.oj)()}),children:(0,a.jsx)("div",{className:T()("relative w-full overflow-clip rounded-md border border-gray-300 dark:border-gray-900",{"panel-height":(0,O.oj)()}),children:(0,a.jsxs)(f.Z,{header:(0,a.jsx)("div",{className:"w-[396px]",children:(0,a.jsx)(h.Header,{imgSrc:S.chainSymbolImageUrl??G.r.Logos.GenericLight,title:(0,a.jsx)(h.Buttons.Wallet,{title:(0,P.fy)(B,10),className:"pr-4 cursor-default"})})}),children:[(0,a.jsxs)("div",{className:"px-7 py-3 overflow-y-auto relative h-[calc(100%-150px)]",children:[(0,a.jsx)("h2",{className:"text-center text-lg font-bold dark:text-white-100 text-gray-900 w-full",children:"Approve Transaction"}),(0,a.jsxs)("div",{className:"flex items-center mt-3 rounded-2xl dark:bg-gray-900 bg-white-100 p-4",children:[(0,a.jsx)(h.Avatar,{avatarImage:K,avatarOnError:(0,H._)(G.r.Misc.Globe),size:"sm",className:"rounded-full overflow-hidden"}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"capitalize text-gray-900 dark:text-white-100 text-base font-bold",children:z}),(0,a.jsx)("p",{className:"lowercase text-gray-500 dark:text-gray-400 text-xs font-medium",children:$})]})]}),(0,a.jsx)(I.ZP,{gasLimit:Z||(null==V?void 0:V.toString()),setGasLimit:e=>q(e.toString()),recommendedGasLimit:null==V?void 0:V.toString(),gasPriceOption:ea,onGasPriceOptionChange:e=>el(e),error:ee,setError:et,considerGasAdjustment:!1,chain:j,rootDenomsStore:o,rootBalanceStore:x,children:(0,a.jsx)(C.m,{className:"mt-3",tabsList:[{id:"fees",label:"Fees"},{id:"details",label:"Details"}],tabsContent:{fees:(0,a.jsxs)("div",{className:"rounded-2xl p-4 mt-3 dark:bg-gray-900 bg-white-100",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("p",{className:"text-gray-500 dark:text-gray-100 text-sm font-medium tracking-wide",children:["Gas Fees ",(0,a.jsxs)("span",{className:"capitalize",children:["(",ea.option,")"]})]}),(0,a.jsx)(E.Z,{content:(0,a.jsx)("p",{className:"text-gray-500 dark:text-gray-100 text-sm",children:"You can choose higher gas fees for faster transaction processing."}),children:(0,a.jsx)("div",{className:"relative ml-2",children:(0,a.jsx)("img",{src:G.r.Misc.InfoCircle,alt:"Hint"})})})]}),(0,a.jsx)(I.ZP.Selector,{className:"mt-2"}),(0,a.jsx)("div",{className:"flex items-center justify-end",children:(0,a.jsx)(I.ZP.AdditionalSettingsToggle,{className:"p-0 mt-3"})}),(0,a.jsx)(I.ZP.AdditionalSettings,{className:"mt-2",showGasLimitWarning:!0,rootDenomsStore:o,rootBalanceStore:x}),ee?(0,a.jsx)("p",{className:"text-red-300 text-sm font-medium mt-2 px-1",children:ee}):null]}),details:(0,a.jsx)("pre",{className:"text-xs text-gray-900 dark:text-white-100 dark:bg-gray-900 bg-white-100 p-4 w-full overflow-x-auto mt-3 rounded-2xl",children:JSON.stringify(r.signTxnData.details,(e,t)=>"bigint"==typeof t?t.toString():t,2)})}})}),ei&&"error"===en?(0,a.jsx)(k._,{text:ei,className:"mt-3"}):null]}),(0,a.jsx)("div",{className:"absolute bottom-0 left-0 py-3 px-7 dark:bg-black-100 bg-gray-50 w-full",children:(0,a.jsxs)("div",{className:"flex items-center justify-center w-full space-x-3",children:[(0,a.jsx)(h.Buttons.Generic,{title:"Reject Button",color:L.w.gray900,onClick:()=>M(w,null==r?void 0:r.payloadId),disabled:"loading"===en,children:"Reject"}),(0,a.jsx)(h.Buttons.Generic,{title:"Approve Button",color:L.w.getChainColor(j),onClick:eg,disabled:ep,className:`${ep?"cursor-not-allowed opacity-50":""}`,children:"loading"===en?(0,a.jsx)(y.T,{color:"white"}):"Approve"})]})})]})})})}),$=D.w.useGetWallet;function z(e){var t,s,n;let{txnData:r}=e,o=$(),d=(0,u.s0)(),x=(0,l.a74)(),m=(0,l.QSC)(x),g=(0,l.rTu)();_()(null!==g,"activeWallet is null");let w=(0,c.useMemo)(()=>(0,R.k)(g.name),[g.name]),v=null==r?void 0:r.origin,N=null==v?void 0:null===(n=v.split("//"))||void 0===n?void 0:null===(s=n.at(-1))||void 0===s?void 0:null===(t=s.split("."))||void 0===t?void 0:t.at(-2),j=(0,A.G)(v),[S,T]=(0,c.useState)("idle"),[E,I]=(0,c.useState)(null),C=async()=>{try{if(g.walletType===l._KQ.LEDGER)throw Error("Ledger transactions are not supported yet");I(null),T("loading");let e=await o(x),t="";"bip322-simple"===r.signTxnData.type&&(t=b.DwL.SignBIP322SimpleMessage(r.signTxnData.message,e)),"ecdsa"===r.signTxnData.type&&(t=await b.DwL.SignECDSA(r.signTxnData.message,e));try{p().runtime.sendMessage({type:i.u.signBitcoinResponse,payloadId:null==r?void 0:r.payloadId,payload:{status:"success",data:t}})}catch{throw Error("Could not send transaction to the dApp")}(0,O.oj)()?d("/home"):window.close()}catch(e){T("error"),I(e.message)}},D=!!E||"loading"===S;return(0,a.jsx)("div",{className:"w-[400px] h-full relative self-center justify-self-center flex justify-center items-center mt-2",children:(0,a.jsx)("div",{className:"relative w-full overflow-clip rounded-md border border-gray-300 dark:border-gray-900",children:(0,a.jsxs)(f.Z,{header:(0,a.jsx)("div",{className:"w-[396px]",children:(0,a.jsx)(h.Header,{imgSrc:m.chainSymbolImageUrl||G.r.Logos.GenericLight,title:(0,a.jsx)(h.Buttons.Wallet,{title:(0,P.fy)(w,10),className:"pr-4 cursor-default"})})}),children:[(0,a.jsxs)("div",{className:"px-7 py-3 overflow-y-auto relative h-[450px]",children:[(0,a.jsx)("h2",{className:"text-center text-lg font-bold dark:text-white-100 text-gray-900 w-full",children:"Signature request"}),(0,a.jsx)("p",{className:"text-center text-sm dark:text-gray-300 text-gray-500 w-full",children:"Only sign this message if you fully understand the content and trust the requesting site"}),(0,a.jsxs)("div",{className:"flex items-center mt-3 rounded-2xl dark:bg-gray-900 bg-white-100 p-4",children:[(0,a.jsx)(h.Avatar,{avatarImage:j,avatarOnError:(0,H._)(G.r.Misc.Globe),size:"sm",className:"rounded-full overflow-hidden"}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"capitalize text-gray-900 dark:text-white-100 text-base font-bold",children:N}),(0,a.jsx)("p",{className:"lowercase text-gray-500 dark:text-gray-400 text-xs font-medium",children:v})]})]}),(0,a.jsx)("p",{className:"text-sm break-words text-gray-900 dark:text-white-100 dark:bg-gray-900 bg-white-100 p-4 w-full overflow-x-auto mt-3 rounded-2xl whitespace-break-spaces",children:r.signTxnData.message}),E&&"error"===S?(0,a.jsx)(k._,{text:E,className:"mt-3"}):null]}),(0,a.jsx)("div",{className:"absolute bottom-0 left-0 py-3 px-7 dark:bg-black-100 bg-gray-50 w-full",children:(0,a.jsxs)("div",{className:"flex items-center justify-center w-full space-x-3",children:[(0,a.jsx)(h.Buttons.Generic,{title:"Reject Button",color:L.w.gray900,onClick:()=>M(d,null==r?void 0:r.payloadId),disabled:"loading"===S,children:"Reject"}),(0,a.jsx)(h.Buttons.Generic,{title:"Approve Button",color:L.w.getChainColor(x),onClick:C,disabled:D,className:`${D?"cursor-not-allowed opacity-50":""}`,children:"loading"===S?(0,a.jsx)(y.T,{color:"white"}):"Sign"})]})})]})})})}var K=s("8974"),Q=s("76354"),Z=s("6391"),q=s.n(Z);let F=D.w.useGetWallet,Y=(0,B.Pi)(e=>{var t,s,n,r,o;let{txnData:d,rootDenomsStore:x,isRedirected:m,handleBack:g}=e,w=F(),v=(0,u.s0)(),N=(0,l.a74)(),j=(0,l.QSC)(N),S=(0,l.rTu)();_()(null!==S,"activeWallet is null");let E=(0,c.useMemo)(()=>(0,R.k)(S.name),[S.name]),I=null==d?void 0:d.origin,C=null==I?void 0:null===(n=I.split("//"))||void 0===n?void 0:null===(s=n.at(-1))||void 0===s?void 0:null===(t=s.split("."))||void 0===t?void 0:t.at(-2),D=(0,A.G)(I),B=(0,c.useMemo)(()=>b.DwL.GetPsbtHexDetails(d.signTxnData.psbtHex,"bitcoinSignet"===N?Q.Pq:Q.IB),[N,d.signTxnData.psbtHex]),W=(0,c.useMemo)(()=>x.allDenoms[Object.keys(j.nativeDenoms)[0]],[j.nativeDenoms,x.allDenoms]),U=(0,l.SFn)(),[$,z]=(0,c.useState)("idle"),[Z,Y]=(0,c.useState)(null),J=async()=>{try{if(S.walletType===l._KQ.LEDGER)throw Error("Ledger transactions are not supported yet");Y(null),z("loading");let e=await w(N);B.inputs.forEach((t,s)=>{if(t.tapScriptInfo){let e=t.tapScriptInfo;B.tx.updateInput(s,{tapMerkleRoot:e.merklePath,tapScriptSig:e.controlBlock,tapInternalKey:e.internalKey,tapLeafScript:e.scriptTree})}e.signIdx(U,B.tx,s)});for(let e=0;e<B.inputs.length;e++)B.tx.finalizeIdx(e);B.tx.extract();let t=K.$v.encode(B.tx.toPSBT());z("success");try{p().runtime.sendMessage({type:i.u.signBitcoinResponse,payloadId:null==d?void 0:d.payloadId,payload:{status:"success",data:t}})}catch{throw Error("Could not send transaction to the dApp")}(0,O.oj)()?v("/home"):window.close()}catch(e){z("error"),Y(e.message)}},V=!!Z||"loading"===$;return(0,a.jsx)("div",{className:T()("panel-width enclosing-panel h-full relative self-center justify-self-center flex justify-center items-center",{"mt-2":!(0,O.oj)()}),children:(0,a.jsx)("div",{className:T()("relative w-full overflow-clip rounded-md border border-gray-300 dark:border-gray-900",{"panel-height":(0,O.oj)()}),children:(0,a.jsxs)(f.Z,{header:(0,a.jsx)("div",{className:"w-[396px]",children:(0,a.jsx)(h.Header,{action:m?{type:h.HeaderActionType.BACK,onClick:g}:void 0,imgSrc:j.chainSymbolImageUrl??G.r.Logos.GenericLight,title:(0,a.jsx)(h.Buttons.Wallet,{title:(0,P.fy)(E,10),className:"pr-4 cursor-default"})})}),children:[(0,a.jsxs)("div",{className:`px-7 py-3 overflow-y-auto relative ${m?"h-[500px]":"h-[450px]"}`,children:[(0,a.jsx)("h2",{className:"text-center text-lg font-bold dark:text-white-100 text-gray-900 w-full",children:m?"Transaction Details":"Sign Transaction"}),m?null:(0,a.jsx)("p",{className:"text-center text-sm dark:text-gray-300 text-gray-500 w-full",children:"Only sign this transaction if you fully understand the content and trust the requesting site"}),m?null:(0,a.jsxs)("div",{className:"flex items-center mt-3 rounded-2xl dark:bg-gray-900 bg-white-100 p-4",children:[(0,a.jsx)(h.Avatar,{avatarImage:D,avatarOnError:(0,H._)(G.r.Misc.Globe),size:"sm",className:"rounded-full overflow-hidden"}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"capitalize text-gray-900 dark:text-white-100 text-base font-bold",children:C}),(0,a.jsx)("p",{className:"lowercase text-gray-500 dark:text-gray-400 text-xs font-medium",children:I})]})]}),(null==B?void 0:B.txAmount)?(0,a.jsxs)("p",{className:"mt-3",children:[(0,a.jsx)("span",{className:"font-semibold text-gray-900 dark:text-white-100 pl-1",children:"Amount"}),(0,a.jsx)("pre",{className:"text-xs text-gray-900 dark:text-white-100 dark:bg-gray-900 bg-white-100 p-4 w-full overflow-x-auto rounded-2xl mt-1",children:`${new(q())(Number(B.txAmount)).dividedBy(10**(W.coinDecimals??8)).toNumber()} ${j.denom}`})]}):null,(null==B?void 0:B.fee)?(0,a.jsxs)("p",{className:"mt-3",children:[(0,a.jsx)("span",{className:"font-semibold text-gray-900 dark:text-white-100 pl-1",children:"Fee"}),(0,a.jsx)("pre",{className:"text-xs text-gray-900 dark:text-white-100 dark:bg-gray-900 bg-white-100 p-4 w-full overflow-x-auto rounded-2xl mt-1",children:`${new(q())(Number(B.fee)).dividedBy(10**(W.coinDecimals??8)).toNumber()} ${j.denom}`})]}):null,(null==B?void 0:null===(r=B.inputs)||void 0===r?void 0:r.length)?(0,a.jsxs)("p",{className:"mt-3",children:[(0,a.jsx)("span",{className:"font-semibold text-gray-900 dark:text-white-100 pl-1",children:"Inputs"}),(0,a.jsx)("pre",{className:"text-xs text-gray-900 dark:text-white-100 dark:bg-gray-900 bg-white-100 p-4 w-full overflow-x-auto rounded-2xl mt-1",children:JSON.stringify(B.inputs,(e,t)=>{if("tapScriptInfo"!==e)return"bigint"==typeof t?`${new(q())(Number(t)).dividedBy(10**(W.coinDecimals??8)).toNumber()} ${j.denom}`:t},2)})]}):null,(null==B?void 0:null===(o=B.outputs)||void 0===o?void 0:o.length)?(0,a.jsxs)("p",{className:"mt-3",children:[(0,a.jsx)("span",{className:"font-semibold text-gray-900 dark:text-white-100 pl-1",children:"Outputs"}),(0,a.jsx)("pre",{className:"text-xs text-gray-900 dark:text-white-100 dark:bg-gray-900 bg-white-100 p-4 w-full overflow-x-auto rounded-2xl mt-1",children:JSON.stringify(B.outputs,(e,t)=>"bigint"==typeof t?`${new(q())(Number(t)).dividedBy(10**(W.coinDecimals??8)).toNumber()} ${j.denom}`:t,2)})]}):null,Z&&"error"===$?(0,a.jsx)(k._,{text:Z,className:"mt-3"}):null]}),m?null:(0,a.jsx)("div",{className:"absolute bottom-0 left-0 py-3 px-7 dark:bg-black-100 bg-gray-50 w-full",children:(0,a.jsxs)("div",{className:"flex items-center justify-center w-full space-x-3",children:[(0,a.jsx)(h.Buttons.Generic,{title:"Reject Button",color:L.w.gray900,onClick:()=>M(v,null==d?void 0:d.payloadId),disabled:"loading"===$,children:"Reject"}),(0,a.jsx)(h.Buttons.Generic,{title:"Approve Button",color:L.w.getChainColor(N),onClick:J,disabled:V,className:`${V?"cursor-not-allowed opacity-50":""}`,children:"loading"===$?(0,a.jsx)(y.T,{color:"white"}):"Sign"})]})})]})})})}),J=D.w.useGetWallet,V=(0,B.Pi)(e=>{var t,s,n;let{txnData:r,rootDenomsStore:o}=e,d=J(),x=(0,u.s0)(),m=(0,l.a74)(),g=(0,l.QSC)(m),w=(0,l.rTu)();_()(null!==w,"activeWallet is null");let v=(0,c.useMemo)(()=>(0,R.k)(w.name),[w.name]),N=null==r?void 0:r.origin,j=null==N?void 0:null===(n=N.split("//"))||void 0===n?void 0:null===(s=n.at(-1))||void 0===s?void 0:null===(t=s.split("."))||void 0===t?void 0:t.at(-2),S=(0,A.G)(N),E=(0,c.useMemo)(()=>r.signTxnData.psbtsHexes.map(e=>b.DwL.GetPsbtHexDetails(e,"bitcoinSignet"===m?Q.Pq:Q.IB)),[m,r.signTxnData.psbtsHexes]),I=(0,l.SFn)(),[C,D]=(0,c.useState)("idle"),[B,W]=(0,c.useState)(null),[U,$]=(0,c.useState)(null),z=async()=>{try{if(w.walletType===l._KQ.LEDGER)throw Error("Ledger transactions are not supported yet");W(null),D("loading");let e=await d(m),t=[];for(let s of E){s.inputs.forEach((t,a)=>{e.signIdx(I,s.tx,a)});for(let e=0;e<s.inputs.length;e++)E.tx.finalizeIdx(e);t.push(K.$v.encode(s.tx.extract()))}D("success");try{p().runtime.sendMessage({type:i.u.signBitcoinResponse,payloadId:null==r?void 0:r.payloadId,payload:{status:"success",data:t}})}catch{throw Error("Could not send transaction to the dApp")}(0,O.oj)()?x("/home"):window.close()}catch(e){D("error"),W(e.message)}},Z=!!B||"loading"===C;return null!==U?(0,a.jsx)(Y,{txnData:{...r,signTxnData:{psbtHex:r.signTxnData.psbtsHexes[U]}},rootDenomsStore:o,isRedirected:!0,handleBack:()=>$(null)}):(0,a.jsx)("div",{className:T()("panel-width enclosing-panel h-full relative self-center justify-self-center flex justify-center items-center",{"mt-2":!(0,O.oj)()}),children:(0,a.jsx)("div",{className:T()("relative w-full overflow-clip rounded-md border border-gray-300 dark:border-gray-900",{"panel-height":(0,O.oj)()}),children:(0,a.jsxs)(f.Z,{header:(0,a.jsx)("div",{className:"w-[396px]",children:(0,a.jsx)(h.Header,{imgSrc:g.chainSymbolImageUrl??G.r.Logos.GenericLight,title:(0,a.jsx)(h.Buttons.Wallet,{title:(0,P.fy)(v,10),className:"pr-4 cursor-default"})})}),children:[(0,a.jsxs)("div",{className:"px-7 py-3 overflow-y-auto relative h-[450px]",children:[(0,a.jsx)("h2",{className:"text-center text-lg font-bold dark:text-white-100 text-gray-900 w-full",children:"Sign Multiple Transactions"}),(0,a.jsx)("p",{className:"text-center text-sm dark:text-gray-300 text-gray-500 w-full",children:"Only sign these transactions if you fully understand the content and trust the requesting site"}),(0,a.jsxs)("div",{className:"flex items-center mt-3 rounded-2xl dark:bg-gray-900 bg-white-100 p-4",children:[(0,a.jsx)(h.Avatar,{avatarImage:S,avatarOnError:(0,H._)(G.r.Misc.Globe),size:"sm",className:"rounded-full overflow-hidden"}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"capitalize text-gray-900 dark:text-white-100 text-base font-bold",children:j}),(0,a.jsx)("p",{className:"lowercase text-gray-500 dark:text-gray-400 text-xs font-medium",children:N})]})]}),r.signTxnData.psbtsHexes.length?r.signTxnData.psbtsHexes.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4 dark:bg-gray-900 bg-white-100 p-4 rounded-2xl mt-3",children:[(0,a.jsxs)("p",{className:"flex flex-col text-gray-900 dark:text-white-100",children:[(0,a.jsxs)("span",{className:"font-semibold",children:["Transaction ",t+1]}),(0,a.jsx)("span",{children:(0,P.Hn)(e,7)})]}),(0,a.jsx)("button",{className:"rounded-lg text-white-100 py-[4px] px-[12px] font-semibold",style:{backgroundColor:L.w.getChainColor(m)},onClick:()=>$(t),children:"View"})]},`${e}--${t}`)):null,B&&"error"===C?(0,a.jsx)(k._,{text:B,className:"mt-3"}):null]}),(0,a.jsx)("div",{className:"absolute bottom-0 left-0 py-3 px-7 dark:bg-black-100 bg-gray-50 w-full",children:(0,a.jsxs)("div",{className:"flex items-center justify-center w-full space-x-3",children:[(0,a.jsx)(h.Buttons.Generic,{title:"Reject Button",color:L.w.gray900,onClick:()=>M(x,null==r?void 0:r.payloadId),disabled:"loading"===C,children:"Reject"}),(0,a.jsx)(h.Buttons.Generic,{title:"Approve Button",color:L.w.getChainColor(m),onClick:z,disabled:Z,className:`${Z?"cursor-not-allowed opacity-50":""}`,children:"loading"===C?(0,a.jsx)(y.T,{color:"white"}):"Sign"})]})})]})})})}),X=(e=>{let t=()=>{let t=(0,l.a74)(),s=(0,d.N8)(),[n,o]=(0,c.useState)(!1),[u,x]=(0,c.useState)(null);(0,c.useEffect)(()=>{!async function(){(0,r.mq)(t)||await s("bitcoin"),o(!0)}()},[t]);let m=(0,c.useCallback)(async(e,t)=>{t.id===p().runtime.id&&e.type===i.u.signTransaction&&x(e.payload)},[]);return((0,c.useEffect)(()=>{if(n)return p().runtime.sendMessage({type:i.u.signingPopupOpen}),p().runtime.onMessage.addListener(m),()=>{p().runtime.onMessage.removeListener(m)}},[n,m]),u)?(0,a.jsx)(e,{txnData:u}):(0,a.jsx)(w,{})};return t.displayName=`withBitcoinTxnSigningRequest(${e.displayName})`,t})(c.memo(function(e){let{txnData:t}=e,s=(0,u.s0)();switch((0,c.useEffect)(()=>(window.addEventListener("beforeunload",()=>M(s,null==t?void 0:t.payloadId)),p().storage.local.remove(o.u1),()=>{window.removeEventListener("beforeunload",()=>M(s,null==t?void 0:t.payloadId))}),[]),t.signTxnData.methodType){case n.z3.SEND_BITCOIN:return(0,a.jsx)(U,{txnData:t,rootDenomsStore:x.gb,rootBalanceStore:m.jZ});case n.z3.SIGN_PSBT:return(0,a.jsx)(Y,{txnData:t,rootDenomsStore:x.gb});case n.z3.SIGN_PSBTS:return(0,a.jsx)(V,{txnData:t,rootDenomsStore:x.gb});case n.z3.SIGN_MESSAGE:return(0,a.jsx)(z,{txnData:t});default:return null}}))}}]);